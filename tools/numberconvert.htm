<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="copyright" content="gelnyang@163.com">
<meta name="created" content="20171017">
<title>Number Converter</title>
<style type="text/css">
<!--
body {background: white; color: black;}
h1 {font-family: Arial, sans-serif; line-height: 0.85em; border-bottom: 2px solid;
  margin-bottom: 0.33em; padding-bottom: 0;}

input {background: #EEF;font-size:20px;}
-->
</style>
<script type="text/javascript">
var number;

function dec() {
	try{
		var decValue = document.getElementById('dec').value;
		number = parseInt(decValue.replace(/,/g,""));
		var fstr = formatStr(decValue,3,",");
		if(fstr != decValue) document.getElementById('dec').value = fstr;
		convert("dec");
		message("");
	}catch(e){
		message(e);
	}
}
function hex() {
	try{
		var hexValue = document.getElementById('hex').value;
		number = parseInt(hexValue.replace(/ /g,""), 16);
		var fstr = formatStr(hexValue ,4 ," ");
		if(fstr != hexValue) document.getElementById('hex').value = fstr;
		convert("hex");
		message("");
	}catch(e){
		message(e);
	}
}
function bit() {
	try{
		var bitValue = document.getElementById('bit').value;
		number = parseInt(bitValue.replace(/ /g,""), 2);
		var fstr = formatStr(bitValue,8," ");
		if(fstr != bitValue) document.getElementById('bit').value = fstr;
		convert("bit");
		message("");
	}catch(e){
		message(e);
	}
}

function convert(from){
    if(isNaN(number)){
      return;
    }
    if(from != "dec") document.getElementById('dec').value = number;
    if(from != "hex") document.getElementById('hex').value = format(number.toString(16), 4, "0", " ");
    if(from != "bit") document.getElementById('bit').value = format(number.toString(2), 8, "0", " ");
}

function format(str, groupLength, previousChar, groupSplitter){
    var addLength = groupLength - str.length % groupLength;
    if( groupLength == addLength) addLength = 0;
    while( (addLength--) > 0){
        str = previousChar + str;
    }
    var formatStr="";
    for( var i = 0 ; i < str.length; i=i+groupLength){
        if( i > 0){
            formatStr = formatStr + groupSplitter;
        }
        formatStr = formatStr + str.substr(i , groupLength);
    }
    return formatStr;
}


function formatStr(s, groupLength, groupSplitter){
    var str = s.trim().replace(/ /g,"").replace(/,/g,"");
    var formatStr = "";
    for( var i=str.length; i >0 ; i= i - groupLength){
        var len = groupLength;
        var start = i - len;
        if( start < 0 ) {
            len = i;
            start = 0;
        }
        formatStr =  str.substr(start , len) + formatStr;
        if( i > groupLength){
            formatStr =  groupSplitter + formatStr;
        }
    }
    return formatStr;
}

function message(msg){
	document.getElementById('msg_container').innerText=msg;
}
</script>
</head>
<body>
<h1>Number Converter</h1>

DEC:<input id="dec" size="50" oninput="dec()"/><br/>
HEX:<input id="hex" size="50" oninput="hex()"/> <br/>
&nbsp;&nbsp;BIT:<input id="bit" size="50" oninput="bit()"/>

<div id="msg_container"><div>

</body></html>